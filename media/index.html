<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Media Journal | Drumoak Capital</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#ffffff;--text:#111827;--muted:#6b7280;--line:#e5e7eb;--chip:#f3f4f6;--accent:#4db5ff;}
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;flex-direction:column;}
    nav{background:#fff;border-bottom:1px solid var(--line);padding:.75rem 1.5rem;position:sticky;top:0;z-index:1000;}
    nav ul{list-style:none;margin:0;display:flex;gap:1.5rem;align-items:center;}
    nav a{color:var(--text);text-decoration:none;font-weight:600;}
    nav a:hover{color:var(--accent);}
    nav strong{font-size:1.15rem;margin-right:1rem;}
    main{flex:1;padding:40px 0;}
    .wrap{max-width:980px;margin:0 auto;padding:0 20px;}
    .header{border:1px solid var(--line);border-radius:16px;padding:24px;margin-bottom:24px;}
    h1{margin:0 0 6px;font-size:2rem;line-height:1.2;}
    .sub{color:var(--muted);margin:0;}
    .controls{display:grid;grid-template-columns:1fr 160px 180px 140px;gap:10px;margin:16px 0 8px;}
    .controls input,.controls select{border:1px solid var(--line);border-radius:12px;padding:10px;}
    .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid #111;border-radius:12px;padding:10px 12px;background:#fff;cursor:pointer;}
    .btn.secondary{border-color:var(--line);color:#111;}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 16px;}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px;}
    .card{border:1px solid var(--line);border-radius:16px;padding:16px;}
    .title{font-weight:600;margin:0 0 4px;font-size:16px;}
    .meta{color:var(--muted);font-size:12px;margin:0 0 10px;}
    .why,.notes{font-size:14px;margin:8px 0;}
    .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px;}
    .chip{background:var(--chip);border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;}
    .row{display:flex;gap:10px;align-items:center;justify-content:space-between;}
    .link{color:#111;text-decoration:none;border-bottom:1px dotted #111;}
    .stars{font-size:13px;letter-spacing:1px;color:#f59e0b;}
    .muted{color:var(--muted);}
    dialog{border:none;border-radius:16px;padding:0;width:min(720px,92vw);}
    .modal{padding:20px;}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    .grid1{display:grid;grid-template-columns:1fr;gap:12px;}
    textarea{min-height:90px;resize:vertical;}
    input,select,textarea{border:1px solid var(--line);border-radius:12px;padding:10px;width:100%;}
    .modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:10px;}
    .small{font-size:12px;}
  </style>
</head>
<body>
<nav class="tpc-nav">
  <ul style="display:flex; gap:1.5rem; list-style:none; margin:0; padding:0;">
    <li><strong>Drumoak Capital</strong></li>
    <li><a href="/Drumoak-Capital/">Home</a></li>
    <li><a href="/Drumoak-Capital/About/">About</a></li>
    <li><a href="/Drumoak-Capital/portfolio/">Portfolio</a></li>
    <li><a href="/Drumoak-Capital/portfolio/short-term.html">Portfolio ST</a></li>
    <li><a href="/Drumoak-Capital/portfolio/long-term.html">Portfolio LT</a></li>
    <li><a href="/Drumoak-Capital/history/">History</a></li>
    <li><a href="/Drumoak-Capital/strategy/events.html">Strategy Events</a></li>
    <li><a href="/Drumoak-Capital/strategy/algorithm.html">Strategy Algorithm</a></li>
    <li><a href="/Drumoak-Capital/media/">Media</a></li>
  </ul>
</nav>
<main>
  <div class="wrap">
    <section class="header">
      <h1>Media Journal</h1>
      <p class="sub">Log articles, podcasts, videos, and books you’ve consumed — and why they stood out.</p>
      <div class="controls">
        <input id="q" placeholder="Search title, source, tags, notes…" />
        <select id="typeFilter">
          <option value="">All types</option>
          <option>Article</option>
          <option>Video</option>
          <option>Podcast</option>
          <option>Book</option>
        </select>
        <select id="sort">
          <option value="date_desc">Sort: Newest</option>
          <option value="date_asc">Sort: Oldest</option>
          <option value="rating_desc">Sort: Rating (high→low)</option>
          <option value="rating_asc">Sort: Rating (low→high)</option>
        </select>
        <select id="tagFilter"><option value="">All tags</option></select>
      </div>
      <div class="toolbar">
        <button class="btn" id="addBtn">＋ Add entry</button>
        <button class="btn secondary" id="exportBtn">Export JSON</button>
        <label class="btn secondary" style="cursor:pointer">
          Import JSON <input id="importInput" type="file" accept=".json" hidden>
        </label>
        <span class="muted small">Autosaves locally • No tracking</span>
      </div>
    </section>

    <section id="list" class="grid" aria-live="polite"></section>
  </div>
</main>

<!-- Modal -->
<dialog id="dlg">
  <form method="dialog" class="modal">
    <h3 style="margin:0 0 8px">New Media Entry</h3>
    <div class="grid2">
      <div><label class="small">Type</label><select id="f_type" required>
        <option>Article</option><option>Video</option><option>Podcast</option><option>Book</option></select></div>
      <div><label class="small">Date Consumed</label><input id="f_date" type="date" required></div>
      <div><label class="small">Title</label><input id="f_title" required></div>
      <div><label class="small">Source / Author</label><input id="f_source"></div>
      <div><label class="small">Link</label><input id="f_link" type="url" placeholder="https://…"></div>
      <div><label class="small">Tags (comma-sep)</label><input id="f_tags" placeholder="investing, macro, leadership"></div>
    </div>
    <div class="grid1" style="margin-top:12px">
      <div><label class="small">Why it stood out</label><textarea id="f_why" required></textarea></div>
      <div><label class="small">Notes / Key ideas</label><textarea id="f_notes"></textarea></div>
      <div><label class="small">1–5 Rating (optional)</label><input id="f_rating" type="number" min="1" max="5" step="1" placeholder="5"></div>
    </div>
    <div class="actions">
      <button class="btn secondary" value="cancel">Cancel</button>
      <button class="btn" id="saveBtn" value="default">Save</button>
    </div>
  </form>
</dialog>


<script>
/** --- Data model ------------------------------------------------------- */
const STORAGE_KEY = "drumoak_media_v1";

/** Example starter entries (delete if you want a blank slate) */
const seed = [
  {
    id: crypto.randomUUID(),
    type: "Podcast",
    date: "2025-08-20",
    title: "The Operating Leverage Playbook",
    source: "Invest Like the Best",
    link: "https://example.com/podcast",
    tags: ["business", "leverage"],
    why: "Clear framework for mapping fixed vs variable costs — useful for DECK/CCL recovery theses.",
    notes: "Key quote: ‘pricing power compounds operating leverage.’",
    rating: 5
  },
  {
    id: crypto.randomUUID(),
    type: "Article",
    date: "2025-08-12",
    title: "Revisiting 13F Drift Effects",
    source: "Alpha Architect",
    link: "https://example.com/article",
    tags: ["factor", "13F", "momentum"],
    why: "Evidence on post-disclosure flows — supports Buffett Bounce logic.",
    notes: "",
    rating: 4
  }
];

function load(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : seed;
  }catch(e){ return seed; }
}
function save(data){ localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); }

let data = load();

/** --- UI state & helpers ---------------------------------------------- */
const listEl = document.getElementById("list");
const qEl = document.getElementById("q");
const typeEl = document.getElementById("typeFilter");
const tagEl = document.getElementById("tagFilter");
const sortEl = document.getElementById("sort");
const dlg = document.getElementById("dlg");

function starStr(n){ if(!n) return ""; return "★".repeat(n) + "☆".repeat(5-n); }

function renderFilters(){
  // Populate tag filter from current data
  const tags = [...new Set(data.flatMap(x => x.tags||[]))].sort();
  tagEl.innerHTML = '<option value="">All tags</option>' + tags.map(t=>`<option>${t}</option>`).join("");
}

function render(){
  const q = qEl.value.trim().toLowerCase();
  const t = typeEl.value;
  const tag = tagEl.value;
  const sort = sortEl.value;

  let rows = data.filter(x=>{
    const blob = [x.title,x.source,(x.tags||[]).join(" "),x.why,x.notes].join(" ").toLowerCase();
    const okQ = !q || blob.includes(q);
    const okT = !t || x.type===t;
    const okTag = !tag || (x.tags||[]).includes(tag);
    return okQ && okT && okTag;
  });

  rows.sort((a,b)=>{
    if(sort==="date_desc") return (b.date||"") > (a.date||"") ? 1 : -1;
    if(sort==="date_asc") return (a.date||"") > (b.date||"") ? 1 : -1;
    if(sort==="rating_desc") return (b.rating||0) - (a.rating||0);
    if(sort==="rating_asc") return (a.rating||0) - (b.rating||0);
    return 0;
  });

  listEl.innerHTML = rows.map(x=>cardHTML(x)).join("") || emptyHTML();
}

function cardHTML(x){
  const url = x.link ? `<a class="link" href="${x.link}" target="_blank" rel="noopener">Open link</a>` : '<span class="muted">No link</span>';
  const tags = (x.tags||[]).map(t=>`<span class="chip">${t}</span>`).join("");
  return `
    <article class="card">
      <div class="row">
        <div class="chip">${x.type}</div>
        <div class="stars" title="Rating">${starStr(x.rating||0)}</div>
      </div>
      <h3 class="title">${x.title}</h3>
      <p class="meta">${x.source ? x.source + " • " : ""}${x.date || ""}</p>
      <p class="why"><strong>Why it stood out:</strong> ${escapeHTML(x.why)}</p>
      ${x.notes ? `<p class="notes"><strong>Notes:</strong> ${escapeHTML(x.notes)}</p>` : ""}
      <div class="row">
        <div class="chips">${tags}</div>
        <div style="display:flex; gap:6px">
          ${url}
          <button class="btn secondary small" onclick="del('${x.id}')">Delete</button>
        </div>
      </div>
    </article>
  `;
}
function emptyHTML(){
  return `<div class="card"><p class="muted">No entries yet. Click “Add entry” to log your first article, podcast, video, or book.</p></div>`;
}
function escapeHTML(s){ return (s||"").replace(/[&<>"']/g,m=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[m])); }

/** --- CRUD ------------------------------------------------------------- */
function openModal(){
  document.getElementById("f_type").value = "Article";
  document.getElementById("f_date").valueAsDate = new Date();
  ["f_title","f_source","f_link","f_tags","f_why","f_notes","f_rating"].forEach(id=>document.getElementById(id).value="");
  dlg.showModal();
}
function saveFromModal(e){
  e?.preventDefault?.();
  const entry = {
    id: crypto.randomUUID(),
    type: document.getElementById("f_type").value.trim(),
    date: document.getElementById("f_date").value,
    title: document.getElementById("f_title").value.trim(),
    source: document.getElementById("f_source").value.trim(),
    link: document.getElementById("f_link").value.trim(),
    tags: document.getElementById("f_tags").value.split(",").map(s=>s.trim()).filter(Boolean),
    why: document.getElementById("f_why").value.trim(),
    notes: document.getElementById("f_notes").value.trim(),
    rating: Number(document.getElementById("f_rating").value||0) || undefined
  };
  data.unshift(entry);
  save(data); renderFilters(); render();
  dlg.close();
}
function del(id){
  if(!confirm("Delete this entry?")) return;
  data = data.filter(x=>x.id!==id);
  save(data); renderFilters(); render();
}

/** --- Export / Import -------------------------------------------------- */
function exportJSON(){
  const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "media_journal.json";
  a.click();
  URL.revokeObjectURL(a.href);
}
function importJSON(file){
  const fr = new FileReader();
  fr.onload = () => {
    try{
      const obj = JSON.parse(fr.result);
      if(!Array.isArray(obj)) throw new Error("Invalid file");
      // normalize
      data = obj.map(x=>({ id: x.id || crypto.randomUUID(), ...x }));
      save(data); renderFilters(); render();
    }catch(e){ alert("Import failed: " + e.message); }
  };
  fr.readAsText(file);
}

/** --- Events ----------------------------------------------------------- */
document.getElementById("addBtn").onclick = openModal;
document.getElementById("saveBtn").onclick = saveFromModal;
document.getElementById("exportBtn").onclick = exportJSON;
document.getElementById("importInput").onchange = (e)=>{ const f=e.target.files?.[0]; if(f) importJSON(f); };

[qEl, typeEl, tagEl, sortEl].forEach(el => el.addEventListener("input", render));

/** init */
renderFilters(); render();
</script>
</body>
</html>
